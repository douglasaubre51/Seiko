<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
			 xmlns:model="clr-namespace:Seiko.Models"
			 xmlns:pageModel="clr-namespace:Seiko.PageModels"
			 x:DataType="pageModel:MainPagePM"
             x:Class="Seiko.Pages.MainPage"
			 x:Name="RootView"
             Title="{Binding Title}">
	<Grid ColumnDefinitions="*,*"
			RowDefinitions="*,Auto"
			ColumnSpacing="5"
			>
		<CollectionView BackgroundColor="Transparent"
						Grid.ColumnSpan="2"
						Margin="8"
						ItemsSource="{Binding Monkeys}"
						SelectionMode="None"
						>
			<CollectionView.ItemTemplate>
				<DataTemplate x:DataType="model:Monkey">
					<Grid Padding="10">
						<Frame HeightRequest="125"
								Padding="0"
								IsEnabled="{Binding IsNotBusy,Source={RelativeSource AncestorType={x:Type pageModel:MainPagePM}},x:DataType=pageModel:MainPagePM}"
							   >
							<Frame.GestureRecognizers>
								<TapGestureRecognizer 
													  Command="{Binding Path=GoToMonkeyDetailsCommand,Source={RelativeSource AncestorType={x:Type pageModel:MainPagePM}},x:DataType=pageModel:MainPagePM }"
														CommandParameter="{Binding .}"
														/>

							</Frame.GestureRecognizers>
							<Grid 
								Padding="0"
								ColumnSpacing="10"
								ColumnDefinitions="125,*"
								VerticalOptions="CenterAndExpand"
								  >
								<Image Aspect="AspectFill"
									   Source="{Binding Image}"
									   WidthRequest="125"
									   HeightRequest="125"
									   />
								<VerticalStackLayout
									Grid.Column="1"
									VerticalOptions="CenterAndExpand"
									>
									<Label Text="{Binding Name}"
										/>
									<Label Text="{Binding Location}"
										/>
								</VerticalStackLayout>
							</Grid>
						</Frame>
					</Grid>
				</DataTemplate>
			</CollectionView.ItemTemplate>
		</CollectionView>

		<Button Text="fetch"
				Command="{Binding GetMonkeyDetailsCommand}"
				IsEnabled="{Binding IsNotBusy}"
				Grid.Row="1"
				Margin="8"
				/>
        <Button Text="fetch closest monkey"
				Command="{Binding GetClosestMonkeyCommand}"	
				IsEnabled="{Binding IsNotBusy}"
				Grid.Row="1"
				Grid.Column="1"
				Margin="8"
                />
        <ActivityIndicator IsVisible="{Binding IsBusy}"
							IsRunning="{Binding IsBusy}"
							HorizontalOptions="FillAndExpand"
							VerticalOptions="CenterAndExpand"
							Grid.RowSpan="2"
							Grid.ColumnSpan="2"
							/>
	</Grid>
</ContentPage>
